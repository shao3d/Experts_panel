# üöÄ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —ç–∫—Å–ø–µ—Ä—Ç–∞ (–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º)

**–í–µ—Ä—Å–∏—è:** 4.0 (–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è)
**–î–∞—Ç–∞:** 2025-12-02
**–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç—É–∞–ª—å–Ω–æ

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–≥–æ —ç–∫—Å–ø–µ—Ä—Ç–∞ –≤ —Å–∏—Å—Ç–µ–º—É —Å –ø–æ–º–æ—â—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ `scripts/add_new_expert.sh`.

---

## üìã –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **JSON –≠–∫—Å–ø–æ—Ä—Ç –∫–∞–Ω–∞–ª–∞:**
   - Telegram Desktop -> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞–Ω–∞–ª–∞ -> –¢—Ä–∏ —Ç–æ—á–∫–∏ -> Export chat history.
   - –í—ã–±—Ä–∞—Ç—å —Ñ–æ—Ä–º–∞—Ç **JSON**.
   - –°–∫–∞—á–∞—Ç—å —Ñ–∞–π–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, `result.json`).

2. **–î–æ—Å—Ç—É–ø –∫ Telegram API:**
   - –í —Ñ–∞–π–ª–µ `backend/.env` –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:
     - `TELEGRAM_API_ID`
     - `TELEGRAM_API_HASH`
     - `TELEGRAM_SESSION_NAME` (—Ñ–∞–π–ª —Å–µ—Å—Å–∏–∏ –¥–æ–ª–∂–µ–Ω —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å)

3. **–î–æ—Å—Ç—É–ø –∫ Google AI Studio:**
   - –î–ª—è Drift Analysis —Ç—Ä–µ–±—É—é—Ç—Å—è –∫–ª—é—á–∏ `GOOGLE_AI_STUDIO_API_KEY` –≤ `.env` (–∏–ª–∏ —Å–µ–∫—Ä–µ—Ç—ã Fly.io).

---

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è

### 1. –ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ
–í–∞–º –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è:
*   **ID —ç–∫—Å–ø–µ—Ä—Ç–∞** (`expert_id`): –£–Ω–∏–∫–∞–ª—å–Ω—ã–π ID (–∞–Ω–≥–ª–∏–π—Å–∫–∏–π, –±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤, –Ω–∞–ø—Ä. `crypto_guru`).
*   **–ò–º—è —ç–∫—Å–ø–µ—Ä—Ç–∞** (`Display Name`): –ò–º—è –¥–ª—è —Å–∞–π—Ç–∞ (–≤ –∫–∞–≤—ã—á–∫–∞—Ö, –Ω–∞–ø—Ä. `"Crypto Guru üöÄ"`).
*   **–Æ–∑–µ—Ä–Ω–µ–π–º –∫–∞–Ω–∞–ª–∞** (`username`): –°—Å—ã–ª–∫–∞ –Ω–∞ –∫–∞–Ω–∞–ª –±–µ–∑ `@` (–Ω–∞–ø—Ä. `crypto_insider`).
*   **–ü—É—Ç—å –∫ —Ñ–∞–π–ª—É** (`json_path`): –ü—É—Ç—å –∫ —Å–∫–∞—á–∞–Ω–Ω–æ–º—É JSON —Ñ–∞–π–ª—É.

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç
–û—Ç–∫—Ä–æ–π—Ç–µ —Ç–µ—Ä–º–∏–Ω–∞–ª –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:

```bash
./scripts/add_new_expert.sh <expert_id> "<Display Name>" <username> <json_path>
```

**–ü—Ä–∏–º–µ—Ä:**
```bash
./scripts/add_new_expert.sh ai_grabli "AI –∏ –≥—Ä–∞–±–ª–∏" oestick data/exports/result.json
```

### 3. –ß—Ç–æ –ø—Ä–æ–∏–∑–æ–π–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
–°–∫—Ä–∏–ø—Ç –≤—ã–ø–æ–ª–Ω–∏—Ç —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:

1.  **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (Step 1):**
    - –î–æ–±–∞–≤–∏—Ç –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–µ —ç–∫—Å–ø–µ—Ä—Ç–∞ –≤ –±–∞–∑—É.
    - –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –ø–æ—Å—Ç—ã –∏–∑ JSON.
    - **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç `sync_state`** (–Ω–∞—Ö–æ–¥–∏—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ—Å—Ç).

2.  **–í—ã–∫–∞—á–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ (Step 2):**
    - –ó–∞–ø—É—Å—Ç–∏—Ç `sync_channel.py` —Å –≥–ª—É–±–∏–Ω–æ–π 2000 –ø–æ—Å—Ç–æ–≤.
    - –°–∫–∞—á–∞–µ—Ç –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏–∑ Telegram.
    - **–°–æ–∑–¥–∞—Å—Ç –∑–∞–¥–∞—á–∏ –¥–ª—è Drift Analysis** (—Å—Ç–∞—Ç—É—Å `pending`) –≤ —Ç–∞–±–ª–∏—Ü–µ `comment_group_drift`.

3.  **–î–µ–ø–ª–æ–π (Step 3):**
    - –ü—Ä–µ–¥–ª–æ–∂–∏—Ç –∑–∞–ø—É—Å—Ç–∏—Ç—å `update_production_db.sh`.
    - –ï—Å–ª–∏ –≤—ã —Å–æ–≥–ª–∞—Å–∏—Ç–µ—Å—å, –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è **Drift Analysis** (—á–µ—Ä–µ–∑ Gemini, ~15 —Å–µ–∫ –Ω–∞ –ø–æ—Å—Ç).
    - –ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–∞ –±–∞–∑–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ª—å–µ—Ç—Å—è –Ω–∞ Fly.io.

### 4. –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–æ—Ü–µ—Å—Å–∞
- **–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –≤—ã–∫–∞—á–∫–∞ –∫–æ–º–º–µ–Ω—Ç–æ–≤:** 5-15 –º–∏–Ω—É—Ç (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –∫–∞–Ω–∞–ª–∞).
- **Drift Analysis:** –ú–æ–∂–µ—Ç –∑–∞–Ω—è—Ç—å **1-2 —á–∞—Å–∞** (–∏–∑-–∑–∞ –ª–∏–º–∏—Ç–æ–≤ Free Tier Gemini).
  - *–°–æ–≤–µ—Ç:* –ó–∞–ø—É—Å–∫–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç –≤ `screen` –∏–ª–∏ `tmux`, –µ—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –æ—Ç–æ–π—Ç–∏.

---

## üõ†Ô∏è –†—É—á–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (Troubleshooting)

–ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫, –º–æ–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å —à–∞–≥–∏ –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏:

### –¢–æ–ª—å–∫–æ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —ç–∫—Å–ø–µ—Ä—Ç–∞
```bash
python3 backend/tools/add_expert.py expert_id "Name" username path/to.json
```

### –¢–æ–ª—å–∫–æ –≤—ã–∫–∞—á–∫–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏ —Å–æ–∑–¥–∞–Ω–∏–µ Drift –∑–∞–¥–∞—á
```bash
# –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ–¥–∞–π—Ç–µ TELEGRAM_CHANNEL
TELEGRAM_CHANNEL=username python3 backend/sync_channel.py --expert-id expert_id --depth 2000
```

### –¢–æ–ª—å–∫–æ Drift Analysis –∏ –î–µ–ø–ª–æ–π
```bash
./scripts/update_production_db.sh
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ Drift Analysis
```bash
sqlite3 backend/data/experts.db "SELECT analyzed_by, COUNT(*) FROM comment_group_drift WHERE expert_id = 'expert_id' GROUP BY analyzed_by;"
```
–û–∂–∏–¥–∞–µ–º—ã–π —Å—Ç–∞—Ç—É—Å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏: `pending`.
–û–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–µ: `drift_checked_gemini`.
–ë–µ–∑ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤: `no-comments`.
