# ==========================================
# Experts Panel - Environment Configuration
# ==========================================
# Copy this file to .env and fill in your values
# NEVER commit .env file to version control!

# ======================
# REQUIRED VARIABLES
# ======================

# Google AI Studio API Configuration
# Get your key from: https://aistudio.google.com/app/apikey
# You can add multiple keys separated by commas for automatic rotation.
GOOGLE_AI_STUDIO_API_KEY=key1,key2,key3

# Database Configuration
# SQLite database path (relative to project root)
DATABASE_URL=sqlite:///data/experts.db
# For async SQLAlchemy
DATABASE_URL_ASYNC=sqlite+aiosqlite:///data/experts.db

# ======================
# TELEGRAM API CONFIGURATION
# ======================

# Telegram API Credentials
# Get from: https://my.telegram.org (API Development Tools)
TELEGRAM_API_ID=12345678
TELEGRAM_API_HASH=your-telegram-api-hash-here
TELEGRAM_PHONE=+1234567890

# Channel to sync
TELEGRAM_CHANNEL=nobilix

# Sync Configuration
# Number of recent posts to check for new comments on each sync
# Covers ~30 days of posts (catches delayed comments on older posts)
SYNC_DEPTH=10

# Session file name (without .session extension)
TELEGRAM_SESSION_NAME=telegram_fetcher

# ======================
# SERVER CONFIGURATION
# ======================

# Backend API Server
BACKEND_HOST=0.0.0.0
BACKEND_PORT=8000
BACKEND_RELOAD=true
BACKEND_DEBUG=true

# Frontend Development Server
FRONTEND_HOST=localhost
FRONTEND_PORT=3000

# ======================
# SECURITY & CORS
# ======================

# CORS Configuration
# Comma-separated list of allowed origins
CORS_ORIGINS=http://localhost:3000,http://127.0.0.1:3000
CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOW_HEADERS=*

# Secret key for sessions/security (generate with: openssl rand -hex 32)
SECRET_KEY=your-secret-key-here-change-in-production

# ======================
# PIPELINE CONFIGURATION
# ======================

# 7-Phase Map-Resolve-Reduce Pipeline Settings
MAP_CHUNK_SIZE=30
RESOLVE_MAX_DEPTH=2
PIPELINE_TIMEOUT_SECONDS=180

# Medium Posts Scoring Configuration
# Minimum score threshold for Medium posts (0.0-1.0)
MEDIUM_SCORE_THRESHOLD=0.7
# Maximum Medium posts to select after scoring (top N by highest score)
MEDIUM_MAX_SELECTED_POSTS=5
# Memory limit for Medium posts processing (prevents OOM with large datasets)
MEDIUM_MAX_POSTS=50

# ===================================================================
# >>>           MODEL CONFIGURATION (Gemini Only)            <<<
# ===================================================================
# All LLM operations use Google AI Studio with automatic key rotation.
# This is the single place to manage which models are used.

# Model for Map phase (lightweight, fast)
MODEL_MAP=gemini-2.5-flash-lite

# Model for Synthesis (Reduce) and Comment Synthesis phases
MODEL_SYNTHESIS=gemini-3-flash-preview

# Model for Analysis (Translation, Validation)
MODEL_ANALYSIS=gemini-2.0-flash

# Model for Medium Scoring
MODEL_MEDIUM_SCORING=gemini-2.0-flash

# Model for finding Comment Groups
MODEL_COMMENT_GROUPS=gemini-2.0-flash

# Model for offline Drift Analysis (cron jobs)
# Uses gemini-3-flash-preview for Pro-grade reasoning
MODEL_DRIFT_ANALYSIS=gemini-3-flash-preview

# --- Rate Limiting ---
# Maximum parallel API calls for Map phase.
# Keep low (e.g., 5-8) to avoid hitting Google's free tier rate limits (RPM)
MAP_MAX_PARALLEL=8

# Logging
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_FILE=logs/app.log

# ==================================
# Optional: Production Configuration
# ==================================
PRODUCTION_ORIGIN=https://your-production-domain.com

# ======================
# OPTIONAL VARIABLES
# ======================

# Rate Limiting
RATE_LIMIT_ENABLED=false
RATE_LIMIT_PER_MINUTE=60

# Cache Configuration (optional Redis)
CACHE_ENABLED=false
REDIS_URL=redis://localhost:6379/0

# Monitoring (optional)
SENTRY_DSN=
PROMETHEUS_ENABLED=false

# ======================
# ENVIRONMENT MODES
# ======================

# Environment: development, staging, production
ENVIRONMENT=development

# Feature Flags
ENABLE_SSE=true
ENABLE_IMPORT_API=true
ENABLE_COMMENT_COLLECTION=true

# ======================
# NOTES
# ======================
# 1. Database will be created automatically on first run
# 2. In production, set BACKEND_DEBUG=false and BACKEND_RELOAD=false
# 3. Generate a strong SECRET_KEY for production deployments
# 4. Update CORS_ORIGINS for your production domain